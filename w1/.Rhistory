hkre.data <- read.csv("HKRE.csv")
hkre.data
cor(hkre.data,hkre.data$price)
```{r}
hkre.data <- read.csv("HKRE.csv")
cor(hkre.data,hkre.data$price)
qqnorm(hkre.data)
plot(hkre.data)
plot(hkre.data$price)
hist(hkre.data$price)
hist(hkre.data$price)
hist(log(hkre.data$price))
hist(hkre.data$price)
hist(log(hkre.data$price))
qqnorm(log(hkre.data$price))
hist(hkre.data$price)
hist(log(hkre.data$price))
qqnorm(hkre.data$price)
qqnorm(log(hkre.data$price))
View(hkre.data)
fit1 <- lm(price ~., data = hkre.data)
summary(fit1)
factor(hkre.data$view)
fit1 <- lm(price ~., data = hkre.data)
summary(fit1)
hkre.data$view <- factor(hkre.data$view)
fit1 <- lm(price ~., data = hkre.data)
summary(fit1)
hkre.data$view <- factor(hkre.data$view)
fit1 <- lm(log(price) ~., data = hkre.data)
summary(fit1)
hkre.data$view <- factor(hkre.data$view)
fit1 <- lm(log(price) ~ - ID., data = hkre.data)
hkre.data$view <- factor(hkre.data$view)
fit1 <- lm(log(price) ~ -ID., data = hkre.data)
hkre.data$view <- factor(hkre.data$view)
fit1 <- lm(log(price) ~. -ID, data = hkre.data)
summary(fit1)
hkre.data$view <- factor(hkre.data$view)
fit1 <- lm(log(price) ~. -ID, data = hkre.data)
summary(fit1)
aic(fit1)
hkre.data$view <- factor(hkre.data$view)
fit1 <- lm(log(price) ~. -ID, data = hkre.data)
summary(fit1)
AIC(fit1)
backward_model <- step(fit1, direction = "backward")
summary(backward_model)
backward_model <- step(fit1, direction = "backward")
backward_model_fit1 <- step(fit1, direction = "backward")
summary(backward_model_fit1)
fit2 <- lm(log(price) ~ log(area) + log(I(beds+1)) + log(I(baths+1)) + log(I(cars+1)) + log(I(age+1)) + view, data = hkre.data )
fit2 <- lm(log(price) ~ log(area) + log(I(beds+1)) + log(I(baths+1)) + log(I(cars+1)) + log(I(age+1)) + view, data = hkre.data )
summary(fit2)
backward_fit2 <- step(fit2_full, "backward")
fit2_full <- lm(log(price) ~ log(area) + log(I(beds+1)) + log(I(baths+1)) + log(I(cars+1)) + log(I(age+1)) + view, data = hkre.data )
backward_fit2 <- step(fit2_full, direction = "backward")
summary(backward_fit2)
summary(backward_fit2)
fit3_full <- lm(log(price) ~ I(area^2) + I(beds^2) + I(baths^2) + I(cars^2) + I(age^2) + view, data = hkre.data )
backward_fit3 <- step(fit3_full, direction = "backward")
summary(backward_fit3)
fit2_full <- lm(log(price) ~ log(area) + log(I(beds+1)) + log(I(baths+1)) + log(I(cars+1)) + log(I(age+1)) + log(I(floor)) + view, data = hkre.data )
backward_fit2 <- step(fit2_full, direction = "backward")
summary(backward_fit2)
fit3_full <- lm(log(price) ~ I(area^2) + I(beds^2) + I(baths^2) + I(cars^2) + I(age^2) + I(floor^2) + view, data = hkre.data )
backward_fit3 <- step(fit3_full, direction = "backward")
summary(backward_fit3)
fit3_full <- lm(log(price) ~ I(area^3) + I(beds^3) + I(baths^3) + I(cars^3) + I(age^3) + I(floor^3) + view, data = hkre.data )
backward_fit3 <- step(fit3_full, direction = "backward")
summary(backward_fit3)
fit3_full <- lm(log(price) ~ I(area^3) + I(beds^3) + I(baths^3) + I(cars^3) + I(age^3) + I(floor^3) + view, data = hkre.data )
backward_fit3 <- step(fit3_full, direction = "backward")
summary(backward_fit3)
fit4_full <- lm(log(price) ~ I(area^3) + I(beds^3) + I(baths^3) + I(cars^3) + I(age^3) + I(floor^3) + view, data = hkre.data )
backward_fit4 <- step(fit4_full, direction = "backward")
summary(backward_fit4)
fit5_full <- lm(log(price) ~ I(area^4) + I(beds^4) + I(baths^4) + I(cars^4) + I(age^4) + I(floor^4) + view, data = hkre.data )
backward_fit5 <- step(fit5_full, direction = "backward")
summary(backward_fit5)
fit6_full <- lm(log(price) ~. -ID + area*view, data = hkre.data )
backward_fit6 <- step(fit6_full, direction = "backward")
summary(backward_fit6)
fit6_full <- lm(log(price) ~. -ID + area*view, data = hkre.data )
backward_fit6 <- step(fit6_full, direction = "backward")
summary(backward_fit6)
summary(fit6_full)
fit6_full <- lm(log(price) ~. -ID + area*view + area*cars, data = hkre.data )
backward_fit6 <- step(fit6_full, direction = "backward")
summary(backward_fit6)
summary(fit6_full)
fit6_full <- lm(log(price) ~. -ID + area*view + area*cars + area*beds, data = hkre.data )
backward_fit6 <- step(fit6_full, direction = "backward")
summary(backward_fit6)
hkre.data <- read.csv("HKRE.csv")
cor(hkre.data,hkre.data$price)
hist(hkre.data$price)
hist(log(hkre.data$price))
qqnorm(hkre.data$price)
qqnorm(log(hkre.data$price))
hkre.data$view <- factor(hkre.data$view)
fit1 <- lm(log(price) ~. -ID, data = hkre.data)
summary(fit1)
AIC(fit1)
backward_model_fit1 <- step(fit1, direction = "backward")
summary(backward_model_fit1)
fit2_full <- lm(log(price) ~ log(area) + log(I(beds+1)) + log(I(baths+1)) + log(I(cars+1)) + log(I(age+1)) + log(I(floor)) + view, data = hkre.data )
backward_fit2 <- step(fit2_full, direction = "backward")
summary(backward_fit2)
fit3_full <- lm(log(price) ~ I(area^2) + I(beds^2) + I(baths^2) + I(cars^2) + I(age^2) + I(floor^2) + view, data = hkre.data )
backward_fit3 <- step(fit3_full, direction = "backward")
summary(backward_fit3)
fit4_full <- lm(log(price) ~ I(area^3) + I(beds^3) + I(baths^3) + I(cars^3) + I(age^3) + I(floor^3) + view, data = hkre.data )
backward_fit4 <- step(fit4_full, direction = "backward")
summary(backward_fit4)
fit5_full <- lm(log(price) ~ I(area^4) + I(beds^4) + I(baths^4) + I(cars^4) + I(age^4) + I(floor^4) + view, data = hkre.data )
backward_fit5 <- step(fit5_full, direction = "backward")
summary(backward_fit5)
fit6_full <- lm(log(price) ~. -ID + area*view + area*cars + area*beds, data = hkre.data )
backward_fit6 <- step(fit6_full, direction = "backward")
summary(backward_fit6)
fit3_full <- lm(log(price) ~ I(area^2) + I(beds^2) + I(baths^2) + I(cars^2) + I(age^2) + I(floor^2) + view, data = hkre.data )
backward_fit3 <- step(fit3_full, direction = "backward")
summary(backward_fit3)
AIC(backward_fit3)
summary(backward_fit3)
AIC(backward_fit3)
backward_fit3 <- step(fit3_full, direction = "backward")
AIC(backward_fit3)
backward_fit3
summary(backward_fit3)
AIC(backward_fit3)
step(fit3_full, direction = "backward")
AIC(fit3_full)
backward_fit3 <- stepAIC(fit3_full, direction = "backward")
Library(MASS)
library(MASS)
fit3_full <- lm(log(price) ~ I(area^2) + I(beds^2) + I(baths^2) + I(cars^2) + I(age^2) + I(floor^2) + view, data = hkre.data )
backward_fit3 <- stepAIC(fit3_full, direction = "backward")
summary(backward_fit3)
AIC(backward_fit3)
fit3_full <- lm(log(price) ~ I(area^2) + I(beds^2) + I(baths^2) + I(cars^2) + I(age^2) + I(floor^2) + view, data = hkre.data )
backward_fit3 <- stepAIC(fit3_full, direction = "backward")
summary(backward_fit3)
AIC(backward_fit3)
fit_inter <- im(log(price) ~ 1, data = hkre.data)
fit3_full <- lm(log(price) ~ I(area^2) + I(beds^2) + I(baths^2) + I(cars^2) + I(age^2) + I(floor^2) + view, data = hkre.data )
backward_fit3 <- stepAIC(fit3_full, direction = "backward")
summary(backward_fit3)
AIC(backward_fit3)
fit_inter <- lm(log(price) ~ 1, data = hkre.data)
summary(fit_inter)
fit3_full <- lm(log(price) ~ I(area^2) + I(beds^2) + I(baths^2) + I(cars^2) + I(age^2) + I(floor^2) + view, data = hkre.data )
backward_fit3 <- stepAIC(fit3_full, direction = "backward")
summary(backward_fit3)
AIC(backward_fit3)
fit_inter <- lm(log(price) ~ 1, data = hkre.data)
AIC(fit_inter)
# Load the built-in mtcars dataset
data(mtcars)
# Fit the full model with all predictors
full_model <- lm(mpg ~ ., data = mtcars)
# Perform backward selection using step()
selected_model <- step(full_model, direction = "backward")
# Calculate AIC for the full model
aic_full_model <- AIC(full_model)
# Calculate AIC for the final model obtained from step()
aic_selected_model <- AIC(selected_model)
# Fit the intercept-only model
intercept_only_model <- lm(mpg ~ 1, data = mtcars)
# Calculate AIC for the intercept-only model
aic_intercept_only <- AIC(intercept_only_model)
# Print the AIC values
print(paste("AIC of the full model:", aic_full_model))
print(paste("AIC of the final selected model (from step()):", aic_selected_model))
print(paste("AIC of the intercept-only model:", aic_intercept_only))
# Print the final selected model's summary to verify
summary(selected_model)
fit3_full <- lm(log(price) ~ I(area^2) + I(beds^2) + I(baths^2) + I(cars^2) + I(age^2) + I(floor^2) + view, data = hkre.data )
backward_fit3 <- stepAIC(fit3_full, direction = "backward")
summary(backward_fit3)
AIC(backward_fit3)
extractAIC(backward_fit3)
extractAIC(fit3_full) - extractAIC(backward_fit3)
AIC(fit3_full) - AIC(backward_fit3)
loop.string <- c("area", "beds", "baths", "cars", "age", "floor", "view")
onevariable= NULL
for(J in 1:length(loop.string)){
temp.fit=summary(lm(log(price)~hkre.data[,loop.string[J]]))
onevariable=rbind(onevariable, temp.fit$coefficients[2,])
}
loop.string <- c("area", "beds", "baths", "cars", "age", "floor", "view")
onevariable= NULL
for(J in 1:length(loop.string)){
temp.fit=summary(lm(log(hkre.data$price)~hkre.data[,loop.string[J]]))
onevariable=rbind(onevariable, temp.fit$coefficients[2,])
}
rownames(onevariable)=loop.string
loop.string <- c("area", "beds", "baths", "cars", "age", "floor", "view")
onevariable= NULL
for(J in 1:length(loop.string)){
temp.fit=summary(lm(log(hkre.data$price)~hkre.data[,loop.string[J]]))
onevariable=rbind(onevariable, temp.fit$coefficients[2,])
}
rownames(onevariable)=loop.string
onevariable
z.onevariable = NULL
for(i in 1:length(loop.string)) {
temp.fit=summary(lm(log(price)~scale(hkre.data[,loop.string[i]])))
z.onevariable=rbind(z.onevariable.temp.fit$coefficients[2,])
}
z.onevariable = NULL
for(i in 1:length(loop.string)) {
temp.fit=summary(lm(log(hkre.data$price)~scale(hkre.data[,loop.string[i]])))
z.onevariable=rbind(z.onevariable.temp.fit$coefficients[2,])
}
z.onevariable = NULL
for(i in 1:length(loop.string)) {
temp.fit=summary(lm(log(hkre.data$price)~scale(hkre.data[,loop.string[i]])))
z.onevariable=rbind(z.onevariable, temp.fit$coefficients[2,])
}
hkre.data <- read.csv("HKRE.csv")
cor(hkre.data,hkre.data$price)
z.onevariable = NULL
for(i in 1:length(loop.string)) {
temp.fit=summary(lm(log(hkre.data$price)~scale(hkre.data[,loop.string[i]])))
z.onevariable=rbind(z.onevariable, temp.fit$coefficients[2,])
}
rownames(z.onevariable)=loop.string
round(z.onevariable, 2)
#
# standardize the variables
hkre.data_std <- hkre.data %>%
mutate(across(c(area, beds, baths, cars, age, floor, view), scale))
library(dplyr)
z.onevariable = NULL
for(i in 1:length(loop.string)) {
temp.fit=summary(lm(log(hkre.data$price)~scale(hkre.data[,loop.string[i]])))
z.onevariable=rbind(z.onevariable, temp.fit$coefficients[2,])
}
rownames(z.onevariable)=loop.string
round(z.onevariable, 2)
#
# standardize the variables
hkre.data_std <- hkre.data %>%
mutate(across(c(area, beds, baths, cars, age, floor, view), scale))
summary(lm(log(price) ~ area + beds + baths + cars + age + floor + view, data=hkre.data))
knitr::opts_chunk$set(echo = TRUE)
library(tsibbledata)
install.packages("fable")
install.packages("tsible")
install.packages("tsibbledata")
library(tsibbledata)
beer_data <- tsibbledata::aus_production
head(beer_data)
